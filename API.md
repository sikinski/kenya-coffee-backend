# API Документация

## Аутентификация

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| POST | `/auth` | Вход в систему | `username` (string, обязательное), `password` (string, обязательное) | Нет |
| POST | `/refresh` | Обновление токенов | `refresh_token` (string, обязательное) | Нет |

---

## Пользователи

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/users` | Получить список пользователей | - | Да |

---

## Задачи (Tasks)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/tasks` | Получить все задачи | - | Да |
| POST | `/tasks` | Создать задачу | `text` (string, обязательное), `priority` (string, опционально: 'low', 'normal', 'high'), `order` (number, опционально) | Да |
| PUT | `/tasks/:id` | Обновить задачу | `text` (string, опционально), `priority` (string, опционально), `order` (number, опционально), `active` (boolean, опционально) | Да |
| PUT | `/tasks/order` | Обновить порядок задач (массовое обновление) | `tasks` (array, обязательное: массив объектов `{id, order}`) | Да |
| DELETE | `/tasks/:id` | Удалить задачу | - | Да |

---

## Ежедневные задачи (Daily Tasks)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/daily-tasks` | Получить задачи на день | `date` (string, опционально, формат: YYYY-MM-DD, по умолчанию сегодня) | Да |
| PUT | `/daily-tasks/:id` | Обновить ежедневную задачу | `done` (boolean, опционально), `userId` (number, опционально) | Да |
| DELETE | `/daily-tasks/:id` | Удалить ежедневную задачу | - | Да |
| POST | `/daily-tasks/sync` | Синхронизировать сегодняшний чеклист с шаблоном задач | - | Да |

---

## Заметки (Notes)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/notes` | Получить заметки | `topics` (string, опционально: список ID через запятую, например "2,3,5") | Да |
| POST | `/notes` | Создать заметку | `text` (string, обязательное), `topicId` (number, опционально) | Да |
| PUT | `/notes/:id` | Обновить заметку | `text` (string, обязательное) | Да |
| DELETE | `/notes/:id` | Удалить заметку | - | Да |

---

## Темы заметок (Note Topics)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/note-topics` | Получить все темы заметок | - | Да |
| POST | `/note-topics` | Создать тему заметки | `name` (string, обязательное), `color` (string, обязательное) | Да |
| DELETE | `/note-topics/:id` | Удалить тему заметки | - | Да |

---

## Меню - Типы (Menu Types)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/menu/types` | Получить все типы позиций | - | Нет (публичный) |
| POST | `/menu/types` | Создать тип позиции | `name` (string, обязательное), `description` (string, опционально), `order` (number, опционально), `icon` (string, опционально: SVG data URI) | Да |
| PUT | `/menu/types/:id` | Обновить тип позиции | `name` (string, опционально), `description` (string, опционально), `order` (number, опционально), `icon` (string, опционально: SVG data URI или null) | Да |
| DELETE | `/menu/types/:id` | Удалить тип позиции | - | Да |

---

## Меню - Теги (Menu Tags)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/menu/tags` | Получить все теги | - | Нет (публичный) |
| POST | `/menu/tags` | Создать тег | `name` (string, обязательное), `color` (string, опционально) | Да |
| PUT | `/menu/tags/:id` | Обновить тег | `name` (string, опционально), `color` (string, опционально) | Да |
| DELETE | `/menu/tags/:id` | Удалить тег | - | Да |

---

## Меню - Позиции (Menu Items)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/menu/items` | Получить позиции меню | `typeIds` (string, опционально: список ID через запятую), `tagIds` (string, опционально: список ID через запятую), `active` (string, опционально: 'true'/'false', работает только с токеном) | Опционально (без токена - только active:true, с токеном - все) |
| GET | `/menu/items/:id` | Получить позицию меню по ID | - | Нет (публичный) |
| POST | `/menu/items` | Создать позицию меню | `name` (string, обязательное), `description` (string, опционально), `price` (object или number, обязательное: `{from: number, to: number}` или просто число), `typeId` (number, опционально), `tagIds` (array of numbers, опционально), `images` (array, опционально: массив объектов `{imageOrg: string, imageThumbnail: string}`), `order` (number, опционально), `available` (boolean, опционально) | Да |
| PUT | `/menu/items/:id` | Обновить позицию меню | `name` (string, опционально), `description` (string, опционально), `price` (object или number, опционально), `typeId` (number, опционально), `tagIds` (array of numbers, опционально), `images` (array, опционально), `order` (number, опционально), `available` (boolean, опционально) | Да |
| PUT | `/menu/items/order` | Обновить порядок позиций (массовое обновление) | `items` (array, обязательное: массив объектов `{id, order}`) | Да |
| DELETE | `/menu/items/:id` | Удалить позицию меню | - | Да |

---

## Меню - Актуальное меню

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/menu` | Получить актуальное меню | - | Опционально (без токена - только active:true, с токеном - все позиции) |
| PUT | `/menu/update-date` | Обновить дату меню | `date` (string, обязательное, формат: YYYY-MM-DD) | Да |

---

## Изображения

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| POST | `/images` | Загрузить изображение | `file` (multipart/form-data, обязательное) | Да |

---

## Контакты (Contacts)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/contacts` | Получить контакты (один объект) | - | Нет (публичный) |
| PUT | `/contacts` | Обновить контакты | `phone` (string, опционально), `address` (string, опционально), `mapLink` (string, опционально), `workingHours` (array, опционально), `vkLink` (string, опционально), `telegramLink` (string, опционально), `whatsappLink` (string, опционально) | Да |

**Примечание**: Контакты - это синглтон (один объект в системе). Запись создается автоматически при первом обращении с пустыми значениями. В ответе не возвращается `id`.

---

## FAQ (Часто задаваемые вопросы)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/faq` | Получить все FAQ (отсортированы по order) | - | Да |
| GET | `/faq/:id` | Получить FAQ по ID | - | Да |
| POST | `/faq` | Создать FAQ | `question` (string, обязательное), `answer` (string, обязательное), `order` (number, опционально), `active` (boolean, опционально, по умолчанию true) | Да |
| PUT | `/faq/:id` | Обновить FAQ | `question` (string, опционально), `answer` (string, опционально), `order` (number, опционально), `active` (boolean, опционально) | Да |
| PUT | `/faq/order` | Обновить порядок FAQ (массовое обновление) | `faqs` (array, обязательное: массив объектов `{id, order}`) | Да |
| DELETE | `/faq/:id` | Удалить FAQ | - | Да |

---

## AQSI - Устройства

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/aqsi/get-devices` | Получить список устройств | - | Да |
| GET | `/aqsi/shops/:id` | Получить информацию о магазине по ID | - | Да |

---

## AQSI - Чеки (Receipts)

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/aqsi/get-receipts` | Получить чеки с пагинацией | `page` (number, опционально, по умолчанию 1), `page_size` (number, опционально, по умолчанию 20), `devices` (string, опционально: список серийных номеров через запятую), `dates` (object, опционально: `{from: string, to: string}` или `{custom: string}`) | Да |

---

## AQSI - Статистика

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/aqsi/get-stats` | Получить статистику | `dates` (object, опционально: `{from: string, to: string}` или `{custom: string}`) | Да |
| POST | `/aqsi/reset-stats` | Сбросить кэш статистики | - | Да |

---

## AQSI - Графики

| Метод | Эндпоинт | Описание | Поля запроса | Авторизация |
|-------|----------|----------|--------------|-------------|
| GET | `/aqsi/sales-graph` | Получить график продаж | `dates` (object, опционально: `{from: string, to: string}` или `{custom: string}`), `devices` (string, опционально: список серийных номеров через запятую) | Да |
| GET | `/aqsi/products-graph` | Получить график по продуктам | `product_type` (string, обязательное), `dates` (object, опционально: `{from: string, to: string}` или `{custom: string}`), `devices` (string, опционально: список серийных номеров через запятую) | Да |

---

## Примечания

- **Авторизация**: Эндпоинты с пометкой "Да" требуют заголовок `Authorization: Bearer <access_token>`
- **Формат дат**: Используется формат `YYYY-MM-DD` (например, `2024-01-15`)
- **Пагинация**: Для эндпоинтов с пагинацией используется формат `page` и `page_size`
- **Query параметры**: Для сложных объектов (например, `dates`) используйте формат с точками: `dates.from=2024-01-01&dates.to=2024-01-31`

